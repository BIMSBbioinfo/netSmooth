---
title: "netsmooth: example with a toy dataset"
author: "Jonathan Ronen"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{netsmooth}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r}
require(igraph)
require(netsmooth)
```


netsmooth lets you easily use a network, such as a protein-protein interaction network, to smooth quantitative values associated with the network nodes, such as gene expression. This vignette demonstrates the idea using a toy dataset.

## The network

We'll define a netwok with 5 nodes using an adjacency matrix:

```{r}
adj_matrix <- matrix(c(
    0,1,1,0,1,
    1,0,0,0,1,
    1,0,0,1,0,
    0,0,1,0,0,
    1,1,0,0,0
), nrow=5)
rownames(adj_matrix) <- c('A','B','C','D','E')
colnames(adj_matrix) <- c('A','B','C','D','E')

g <- graph_from_adjacency_matrix(adj_matrix, mode='undirected')
plot(g)
```


## Gene expression

Next, let's pretend we have a little gene expression set with these 5 genes:

```{r}
gene_expression <- t(rbind(c(1,0,0,0,0), c(0,0,0,0,3)))
rownames(gene_expression) <- c('A','B','C','D','E')
colnames(gene_expression) <- c('sample 1', 'sample 2')
gene_expression
```


## Network smoothing

We see that sample 1 only expresses gene A, and sample 2 only expresses gene E. Let's run the network smoothing algorithm to see what the smoothed expression might look like:

```{r}
gene_expression_smoothed <- random.walk.by.matrix.inv(gene_expression, adj_matrix, 0.1)
gene_expression_smoothed
```


## Other values of lambda

```{r}
gene_expression_smoothed <- random.walk.by.matrix.inv(gene_expression, adj_matrix, 0.9)
gene_expression_smoothed
```


```{r}
sessionInfo()
```

